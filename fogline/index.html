<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fogline, card-based micro-wargame</title>
    <!-- PeerJS CDN -->
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <!-- Link to external CSS -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h2 style="text-align:center;">Fogline, card-based micro-wargame</h2>

    <!-- Collapsible PeerJS Controls -->
    <details id="connection-details">
        <summary id="connection-summary">Connection Status: Initializing...</summary>
        <div id="peer-controls">
            Your Peer ID:
            <span class="peer-id-container">
                <strong id="my-peer-id" onclick="selectPeerIdText()">Waiting...</strong>
                <span id="copy-peer-id-button" onclick="copyPeerIdToClipboard()" title="Copy Peer ID">copy</span>
            </span>
            <br>
            Connect to Peer ID: <input type="text" id="peer-id-input" placeholder="Enter Peer ID">
            <button id="connect-button" onclick="connectToPeer()">Connect</button>
            <button id="disconnect-button" onclick="disconnectPeer()" disabled>Disconnect</button>
            <br>
            Your Display Name: <input type="text" id="display-name-input" placeholder="Enter Name">
            <!-- Save button removed, name saves on blur -->
            <br>
            Status: <span id="peer-status">Not Connected</span>
        </div>
    </details>

    <!-- Memo Pad Popover -->
    <div id="memo-popover">
        <!-- Content generated by JS -->
    </div>

    <div id="info">Connecting...</div>

    <!-- Placement Phase Controls (hidden initially) -->
    <div id="placement-controls" style="display: none;">
        <h4 id="placement-title">Placement Phase</h4>
        <div class="placement-area">
            <div>
                <h5>Available Units</h5>
                <div id="placement-units-area" class="placement-card-grid">
                    <!-- Unit cards will be generated here -->
                </div>
            </div>
            <div>
                <h5>Available Terrains</h5>
                <div id="placement-terrains-area" class="placement-card-grid">
                    <!-- Terrain cards will be generated here -->
                </div>
            </div>
        </div>
        <p id="placement-instructions">Select one unit and one terrain, then click an empty, valid spot on the board.</p>
        <button id="auto-place-button" onclick="handleAutoPlaceClick()" style="margin-top: 10px; background-color: #ffc107; color: black;">Auto-Place All (Host Only)</button>
    </div>

    <div id="game-area">
        <div id="board"></div>
    </div>

    <div id="controls">
        <button onclick="resetGame()">Reset Game (Requires Reconnect)</button>
        <button id="memo-toggle-button" onclick="toggleMemoPad()" disabled>Show Memo Pad</button>
        <span id="message-log" style="margin-left: 20px; color: #333; font-style: italic;"></span>
    </div>

    <div id="defeated-units">
        <h4>Defeated Units</h4>
    </div>

    <!-- Link to external JavaScript -->
    <!-- Note: autoPlacement.js is imported within script.js -->
    <script type="module" src="script.js"></script>
</body>

</html>